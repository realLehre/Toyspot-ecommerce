import{a as _e}from"./chunk-773VB3WD.js";import{a as ye,b as Se}from"./chunk-N6FCPBOZ.js";import"./chunk-LY6Z3647.js";import"./chunk-YMVSBBTI.js";import"./chunk-JEXPQBO3.js";import"./chunk-HIGJCFN5.js";import"./chunk-BUOL5UUF.js";import"./chunk-XCIH5OP7.js";import{a as ie}from"./chunk-PWBNNIEZ.js";import{a as be}from"./chunk-6M5QZD65.js";import{b as oe,d as le,g as ae,h as se,i as me,j as L,l as de,n as ce,o as pe,u as ue}from"./chunk-HPREADP6.js";import{a as xe}from"./chunk-ZFTML6IP.js";import{a as fe,b as he,c as ge}from"./chunk-EW7AGQTV.js";import"./chunk-TVXJGPRZ.js";import{a as ve}from"./chunk-ENH4ZRLB.js";import{a as re,b as $}from"./chunk-JQIRRWHU.js";import"./chunk-HULGCXHD.js";import{a as ne}from"./chunk-XNVULCNU.js";import{i as te}from"./chunk-L6YWE27G.js";import"./chunk-JMTCKGXD.js";import{k as Z,m as ee}from"./chunk-BLPDBI5E.js";import{k as X,r as M,t as A}from"./chunk-BKPILUOD.js";import{$ as R,Ab as O,Db as E,Eb as p,Mb as a,Nb as J,Oa as B,Ob as u,Ta as m,Vb as P,Wb as D,X as g,Xb as G,Yb as Q,Za as W,ab as V,ba as U,ca as z,cc as _,dc as k,fc as F,hb as v,ja as b,ka as w,kb as x,nb as H,pb as h,rb as K,sb as I,tb as T,ua as Y,ub as n,va as C,vb as r,wa as q,wb as c}from"./chunk-RY22DRUR.js";import"./chunk-X5YLR3NI.js";import"./chunk-ODN5LVDJ.js";var we=(()=>{let i=class i{constructor(){this.renderer=g(W),this.el=g(q),this.timeLine=C.required(),this.status=C.required(),this.completeImageSrc="assets/images/icons/green-tick.svg",this.firstWaitingImageSrc="assets/images/icons/order-loading.svg",this.blankImageSrc="assets/images/icons/order-blank.svg"}ngOnInit(){this.changeSrc(this.status().status)}changeSrc(o){let t=this.timeLine().reduceRight((d,f,y)=>d!==-1?d:f.status?y:-1,-1),s=this.timeLine().findIndex(d=>d.remark==this.status().remark);o?this.setImageSrc(this.completeImageSrc):this.setImageSrc(this.blankImageSrc),!o&&s-t==1&&this.setImageSrc(this.firstWaitingImageSrc)}setImageSrc(o){this.renderer.setProperty(this.el.nativeElement,"src",o)}};i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=U({type:i,selectors:[["","appOrderStatusIcon",""]],inputs:{timeLine:[1,"timeLine"],status:[1,"status"]},standalone:!0});let e=i;return e})();var Ce=(()=>{let i=class i{transform(o){switch(o.toLowerCase()){case"customer paid":return"Verified";case"order confirmed":return"Confirmed";case"order assigned for delivery":return"Packed";case"order delivered":return"Delivered"}return""}};i.\u0275fac=function(t){return new(t||i)},i.\u0275pipe=z({name:"deliveryEventRemark",type:i,pure:!0,standalone:!0});let e=i;return e})();var Ie=(e,i)=>i.id;function Te(e,i){e&1&&c(0,"div",4)}function De(e,i){if(e&1&&(n(0,"span"),a(1),_(2,"date"),r()),e&2){let l=p().$implicit;m(),u(" ",k(2,1,l.updatedAt)," ")}}function Fe(e,i){e&1&&(n(0,"span"),a(1,"Waiting..."),r())}function Re(e,i){if(e&1&&(n(0,"div",1)(1,"div",2),c(2,"img",3),v(3,Te,1,0,"div",4),r(),n(4,"p",5),a(5),_(6,"deliveryEventRemark"),r(),n(7,"div",6),v(8,De,3,3,"span")(9,Fe,2,0,"span"),r()()),e&2){let l,o=i.$implicit,t=i.$index,s=p();m(2),x("timeLine",s.trackingEvents())("status",o),m(),h(t<((l=s.trackingEvents())==null?null:l.length)-1?3:-1),m(2),u(" ",k(6,5,o.remark)," "),m(3),h(o.status?8:9)}}var Ee=(()=>{let i=class i{constructor(){this.trackingEvents=C()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=R({type:i,selectors:[["app-order-tracker"]],inputs:{trackingEvents:[1,"trackingEvents"]},standalone:!0,features:[P],decls:3,vars:0,consts:[[1,"flex","justify-between","items-start","space-x-3"],[1,"grow"],[1,"flex","items-center","space-x-3"],["appOrderStatusIcon","","alt","",1,"w-6","tablet:w-8",3,"timeLine","status"],[1,"bg-border_subtle","h-[2px]","min-w-[40px]","w-[40px]","min-[700px]:w-[120px]","grow","shrink"],[1,"text-type_title_gray","font-medium","my-2","text-sm"],[1,"text-type_caption","font-semibold","text-xs","tablet:text-base"]],template:function(t,s){t&1&&(n(0,"div",0),I(1,Re,10,7,"div",1,Ie),r()),t&2&&(m(),T(s.trackingEvents()))},dependencies:[we,Ce,M],changeDetection:0});let e=i;return e})();var Pe=(e,i)=>i.id,Ge=(e,i)=>i.star,Ve=()=>({width:"25rem"}),Me=()=>({"450px":"90vw"}),ke=e=>({"border-red-500":e}),Ae=e=>({"!text-yellow-400":e}),$e=()=>({width:"16px",border:"3px solid #fff"});function je(e,i){if(e&1){let l=O();n(0,"button",17),E("click",function(){let t;b(l);let s=p(),d=s.$implicit,f=s.$index,y=p(2);return w(y.onReviewProduct(d,(t=y.order())==null||t.orderItems==null?null:t.orderItems[f]))}),a(1," Review product "),r()}}function Be(e,i){if(e&1){let l=O();n(0,"button",18),E("click",function(){let t;b(l);let s=p(),d=s.$implicit,f=s.$index,y=p(2);return w(y.onSeeReview(d,(t=y.order())==null||t.orderItems==null?null:t.orderItems[f]))}),a(1," Product reviewed "),r()}}function Le(e,i){if(e&1){let l=O();n(0,"div")(1,"div",9)(2,"div",10)(3,"img",11),E("click",function(){let t=b(l).$implicit,s=p(2);return w(s.onViewDetails(t.product))}),r(),n(4,"div",12)(5,"p"),a(6),r(),n(7,"p",13),a(8),r()()(),n(9,"p",14),a(10),_(11,"currency"),r()(),v(12,je,2,0,"button",15)(13,Be,2,0,"button",16),r()}if(e&2){let l,o=i.$implicit,t=i.$index,s=p(2);m(3),x("src",o==null||o.product==null?null:o.product.image,B)("alt",o==null||o.product==null?null:o.product.name),m(3),J(o==null||o.product==null?null:o.product.name),m(2),u("x",o.unit,""),m(2),u(" ",F(11,6,o.total,"\u20A6","symbol","1.0-0")," "),m(2),h(((l=s.deliveryStatus())==null?null:l.toLowerCase())==="delivered"&&!(!((l=s.order())==null||l.orderItems==null||l.orderItems[t]==null)&&l.orderItems[t].rating)?12:((l=s.deliveryStatus())==null?null:l.toLowerCase())==="delivered"&&(!((l=s.order())==null||l.orderItems==null||l.orderItems[t]==null)&&l.orderItems[t].rating)?13:-1)}}function Ne(e,i){if(e&1&&(n(0,"div",6)(1,"p"),a(2,"Payment method"),r(),n(3,"p",19),a(4),r()()),e&2){let l=p(2);m(4),u(" ",l.paymentMethod()," ")}}function Ue(e,i){if(e&1&&(n(0,"div",0)(1,"div",3)(2,"div",4)(3,"p"),a(4,"Product"),r(),n(5,"p"),a(6,"Total"),r()(),n(7,"div",5),I(8,Le,14,11,"div",null,Pe),r()(),n(10,"div",6)(11,"p"),a(12,"Subtotal"),r(),n(13,"p",7),a(14),_(15,"subtotal"),_(16,"currency"),r()(),n(17,"div",6)(18,"p"),a(19,"Delivery Fee"),r(),n(20,"p",7),a(21),_(22,"totalDelivery"),_(23,"currency"),r()(),v(24,Ne,5,1,"div",6),n(25,"div",6)(26,"p"),a(27,"Total"),r(),n(28,"p",8),a(29),_(30,"grandTotal"),_(31,"currency"),r()()()),e&2){let l,o,t,s,d=p();m(8),T((l=d.order())==null||l.cartOrder==null?null:l.cartOrder.cartItems),m(6),u(" ",F(16,6,k(15,4,(o=d.order())==null||o.cartOrder==null?null:o.cartOrder.cartItems),"\u20A6","symbol","1.0-0")," "),m(7),u(" ",F(23,13,k(22,11,(t=d.order())==null||t.cartOrder==null?null:t.cartOrder.cartItems),"\u20A6","symbol","1.0-0")," "),m(3),h(d.paymentMethod()?24:-1),m(5),u(" ",F(31,20,k(30,18,(s=d.order())==null||s.cartOrder==null?null:s.cartOrder.cartItems),"\u20A6","symbol","1.0-0")," ")}}function ze(e,i){if(e&1){let l=O();n(0,"i",35),E("click",function(){let t=b(l).$index,s=p(2);return w(s.onSetStar(t))}),r()}if(e&2){let l=i.$implicit;x("ngClass",G(1,Ae,l.active))}}function Ye(e,i){e&1&&c(0,"app-loader",36),e&2&&x("customStyle",D(1,$e))}function qe(e,i){if(e&1&&(n(0,"button",34),v(1,Ye,1,2,"app-loader",36),n(2,"span"),a(3,"Submit"),r()()),e&2){let l=p(2);x("disabled",l.isSubmitting()||l.reviewForm.invalid||l.selectedRating==0),m(),h(l.isSubmitting()?1:-1)}}function We(e,i){if(e&1){let l=O();n(0,"div",20)(1,"div",21),c(2,"img",22),n(3,"div")(4,"p",23),a(5),r(),n(6,"div",24),I(7,ze,1,3,"i",25,Ge),r()()(),n(9,"form",26),E("ngSubmit",function(){b(l);let t=p();return w(t.onSubmitReview())}),n(10,"div")(11,"label",27),a(12,"Title"),r(),c(13,"input",28),r(),n(14,"div",29)(15,"label",30),a(16,"Comment"),r(),n(17,"textarea",31),a(18,"          "),r()(),n(19,"div",32)(20,"button",33),E("click",function(){b(l);let t=p();return w(t.onCloseDialog())}),a(21),r(),v(22,qe,4,2,"button",34),r()()()}if(e&2){let l=p();m(2),x("src",l.selectedProduct.product.image,B)("alt",l.selectedProduct.product.name),m(3),u(" ",l.selectedProduct.product.name," "),m(2),T(l.stars()),m(2),x("formGroup",l.reviewForm),m(4),x("ngClass",G(8,ke,l.isInvalidAndTouched("title"))),m(4),x("ngClass",G(10,ke,l.isInvalidAndTouched("comment"))),m(4),u(" ",l.isReadOnly()?"Close":"Cancel"," "),m(),h(l.isReadOnly()?-1:22)}}var Oe=(()=>{let i=class i{constructor(){this.router=g(ee),this.productService=g(ie),this.reviewService=g(_e),this.toast=g(xe),this.paymentMethod=C(),this.order=C(),this.deliveryStatus=C(),this.showReviewDialog=V(!1),this.isSubmitting=V(!1),this.stars=V(Array.from({length:5},(o,t)=>({star:t+1,active:!1}))),this.selectedRating=0,this.reviewGiven=Y(),this.isReadOnly=V(!1)}ngOnInit(){this.reviewForm=new me({title:new L({value:null,disabled:this.isReadOnly()},le.required),comment:new L({value:null,disabled:this.isReadOnly()})})}isInvalidAndTouched(o){return this.reviewForm.get(o)?.touched&&this.reviewForm.get(o)?.invalid}onViewDetails(o){this.productService.activeProduct.set(o),this.router.navigate(["/product/"+this.productService.createSlug(o.name)],{queryParams:{id:o.id}})}onReviewProduct(o,t){this.selectedProduct=o,this.selectedOrderItem=t,this.showReviewDialog.set(!0)}onSetStar(o){if(this.isReadOnly())return;let t=o+1;this.selectedRating=o+1;let s=Array.from({length:5},(d,f)=>({star:f+1,active:!1}));s=s.map((d,f)=>(f<t&&(d.active=!0),d)),this.stars.set([...s])}onSubmitReview(){if(this.reviewForm.invalid&&this.selectedRating==0){this.reviewForm.markAllAsTouched();return}this.isSubmitting.set(!0);let o={rating:this.selectedRating,title:this.reviewForm.value.title,comment:this.reviewForm.value.comment,productId:this.selectedProduct.productId,orderItemId:this.selectedOrderItem.id,userId:this.order()?.userId};this.reviewService.createReview(o).subscribe({next:t=>{this.reviewGiven.emit(),this.toast.showToast({type:"success",message:"Review submitted successfully!"}),this.isSubmitting.set(!1),this.showReviewDialog.set(!1)},error:t=>{this.isSubmitting.set(!1),this.toast.showToast({type:"error",message:t.error.message})}})}onCloseDialog(){this.showReviewDialog.set(!1),this.isReadOnly.set(!1),this.reviewForm.enable()}onSeeReview(o,t){this.onSetStar(t.rating.rating-1),this.isReadOnly.set(!0),this.reviewForm.disable(),this.selectedProduct=o,this.selectedOrderItem=t,this.showReviewDialog.set(!0),this.reviewForm.setValue({title:t.rating.title,comment:t.rating?.comment||""})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=R({type:i,selectors:[["app-generic-order-summary"]],inputs:{paymentMethod:[1,"paymentMethod"],order:[1,"order"],deliveryStatus:[1,"deliveryStatus"]},outputs:{reviewGiven:"reviewGiven"},standalone:!0,features:[P],decls:3,vars:7,consts:[[1,""],[3,"visible","breakpoints"],["pTemplate","headless"],[1,"pb-3","border-b-[2px]","border-border_subtle"],[1,"flex","items-center","justify-between","space-x-3","text-sm","mobile:text-base","text-type_title_gray","mb-3"],[1,"space-y-3"],[1,"flex","items-center","justify-between","space-x-4","text-sm","mobile:text-base","text-type_title_gray","py-3","border-b-[2px]","border-border_subtle"],[1,"text-type_title_gray","font-semibold"],[1,"text-type_title_gray","font-semibold","text-lg","mobile:text-2xl"],[1,"flex","items-center","justify-between","space-x-3","text-sm","mobile:text-[20px]","text-type_title_gray"],[1,"flex","items-center","space-x-2","w-[70%]"],[1,"w-12","h-12","min-w-12","min-h-12","object-cover",3,"click","src","alt"],[1,"text-sm","text-type_grey","break-words"],[1,"text-type_title","font-semibold"],[1,"text-sm","mobile:text-base","text-type_grey","w-[30%]","text-right","whitespace-nowrap"],[1,"py-2","text-primary","italic","underline","text-sm"],[1,"py-2","text-green-600","italic","underline","text-sm"],[1,"py-2","text-primary","italic","underline","text-sm",3,"click"],[1,"py-2","text-green-600","italic","underline","text-sm",3,"click"],[1,"text-type_title_gray","font-semibold","capitalize"],[1,"p-5","bg-white"],[1,"flex","items-center","space-x-3"],[1,"w-12","h-12","min-w-12","min-h-12","object-cover",3,"src","alt"],[1,"text-base","text-type_grey","break-words"],[1,"space-x-2","mt-2"],[1,"fa","fa-star","text-[30px]","cursor-pointer","text-gray-300",3,"ngClass"],[1,"mt-4",3,"ngSubmit","formGroup"],["for","title",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","title","formControlName","title",1,"w-full","p-2","border-[2px]","rounded-md","focus:outline-none","bg-bg_subtle","text-sm",3,"ngClass"],[1,"mt-3"],["for","comment",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","comment","rows","6","formControlName","comment",1,"w-full","p-2","border-[2px]","rounded-md","focus:outline-none","bg-bg_subtle","text-sm",3,"ngClass"],[1,"flex","items-center","space-x-3","justify-between","mt-12"],["type","button",1,"px-4","py-2","bg-transparent","flex","items-center","justify-center","h-[38px]","border-[2px]","border-primary","rounded-md","hover:border-type_grey","text-primary","hover:text-type_grey","flex-1",3,"click"],["type","submit",1,"px-4","py-2","flex","items-center","justify-center","space-x-2","bg-primary","h-[38px]","text-white","rounded-md","hover:bg-opacity-80","focus:outline-none","disabled:bg-type_grey","flex-1","disabled:cursor-not-allowed",3,"disabled"],[1,"fa","fa-star","text-[30px]","cursor-pointer","text-gray-300",3,"click","ngClass"],[3,"customStyle"]],template:function(t,s){t&1&&(v(0,Ue,32,25,"div",0),n(1,"p-dialog",1),v(2,We,23,12,"ng-template",2),r()),t&2&&(h(s.order()?0:-1),m(),H(D(5,Ve)),x("visible",s.showReviewDialog())("breakpoints",D(6,Me)))},dependencies:[A,fe,he,ge,$,Se,ye,te,ne,X,ue,de,oe,ae,se,ce,pe]});let e=i;return e})();var He=()=>({name:"orders",route:"/orders"}),Ke=e=>({name:"order details",route:e}),Je=(e,i)=>[e,i],Qe=()=>[1,2,3,4];function Xe(e,i){e&1&&(n(0,"h3",21),a(1,"Packed"),r(),n(2,"p",22),a(3," Your order has been packed, to be delivered soon. "),r())}function Ze(e,i){e&1&&(n(0,"h3",21),a(1,"Delivered"),r(),n(2,"p",22),a(3,"Your order has been delivered."),r())}function et(e,i){e&1&&(n(0,"h3",21),a(1,"Verified"),r(),n(2,"p",22),a(3,"Your order has been verified."),r())}function tt(e,i){if(e&1){let l=O();n(0,"div",3)(1,"div",4),v(2,Xe,4,0)(3,Ze,4,0)(4,et,4,0),r(),n(5,"div",5),c(6,"app-order-tracker",6),r(),n(7,"div",7)(8,"div",8)(9,"div",9)(10,"h5",10),a(11,"ORDER ID"),r(),n(12,"p",11),a(13),r()(),c(14,"div",12),n(15,"div",13)(16,"h5",10),a(17,"DATE"),r(),n(18,"p",14),a(19),_(20,"date"),r()(),c(21,"div",12),n(22,"div",15)(23,"h5",10),a(24,"TOTAL"),r(),n(25,"p",14),a(26),_(27,"currency"),r()(),c(28,"div",12),n(29,"div",16)(30,"h5",10),a(31,"PAYMENT METHOD"),r(),n(32,"p",17),a(33),r()()(),n(34,"div",18)(35,"h3",19),a(36," Your Order Details "),r(),n(37,"app-generic-order-summary",20),E("reviewGiven",function(t){b(l);let s=p();return w(s.loadOrderDetails(t))}),r()()()()}if(e&2){let l,o,t,s,d,f,y,N,S=p();m(2),h((l=(l=S.order())==null?null:l.deliveryStatus)==="PACKED"?2:l==="DELIVERED"?3:4),m(4),x("trackingEvents",(o=S.order())==null?null:o.deliveryEvents),m(7),u(" ",(t=S.order())==null?null:t.id," "),m(6),u(" ",k(20,9,(s=S.order())==null?null:s.createdAt)," "),m(7),u(" ",F(27,11,(d=S.order())==null?null:d.totalAmount,"\u20A6","symbol","1.0-0")," "),m(7),u(" ",(f=S.order())==null?null:f.paymentMethod," "),m(4),x("paymentMethod",(y=S.order())==null?null:y.paymentMethod)("order",S.order())("deliveryStatus",(N=S.order())==null?null:N.deliveryStatus)}}function it(e,i){e&1&&(n(0,"div",29)(1,"div"),c(2,"p-skeleton",32),r(),n(3,"div"),c(4,"p-skeleton",33),r(),n(5,"div"),c(6,"p-skeleton",34),r()())}function nt(e,i){e&1&&(n(0,"div",3)(1,"div",23)(2,"div",24),c(3,"p-skeleton",25),r(),n(4,"div",26),c(5,"p-skeleton",27),r()(),n(6,"div",28),I(7,it,7,0,"div",29,K),r(),n(9,"div"),c(10,"p-skeleton",30),r(),n(11,"div"),c(12,"p-skeleton",31),r()()),e&2&&(m(7),T(D(0,Qe)))}var Nt=(()=>{let i=class i{constructor(){this.route=g(Z),this.orderService=g(be),this.order=this.orderService.activeOrder,this.id="",this.route.params.subscribe(o=>{this.id=o.id,this.order()||this.orderService.getOrderById(this.id).subscribe({next:t=>{this.order.set(t)}})})}loadOrderDetails(o){this.order.set(null),this.orderService.orderSignal.set(null),this.orderService.getOrderById(this.id).subscribe({next:t=>{this.order.set(t)}})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=R({type:i,selectors:[["app-user-order-details"]],standalone:!0,features:[P],decls:6,vars:8,consts:[[1,"w-[90%]","tablet:w-[85%]","max-w-[1200px]","mx-auto","mt-9","mobile:mt-[80px]"],[3,"pages"],[1,"block","mobile:hidden","font-medium","text-lg","text-type_title","mt-4"],[1,"w-full","min-[700px]:w-[70%]","max-w-[800px]","mt-8"],[1,"text-center"],[1,"my-8"],[3,"trackingEvents"],[1,"bg-bg_subtle","p-6","pt-9","rounded-md"],[1,"flex","items-start","flex-wrap","justify-between","gap-3"],[1,"flex-1","min-w-[50px]","text-gray-600"],[1,"text-xs","font-medium"],[1,"text-sm","font-semibold","break-all"],[1,"h-10","w-[1px]","border","border-border_subtle"],[1,"flex-1","min-w-[120px]","text-gray-600"],[1,"text-sm","font-semibold"],[1,"flex-1","min-w-[100px]","text-gray-600"],[1,"flex-1","min-w-[150px]","text-gray-600"],[1,"text-sm","font-semibold","capitalize"],[1,"mt-5"],[1,"text-type_title_grey","font-semibold","mb-1"],[3,"reviewGiven","paymentMethod","order","deliveryStatus"],[1,"text-lg","text-[#2E7D32]","mb-1","font-semibold"],[1,"text-sm","text-type_grey"],[1,"flex","items-center","flex-col","justify-center"],[1,"mb-2"],["width","120px","height","1rem"],[1,"w-[80%]","mx-auto"],["width","100%","height","1rem"],[1,"my-8","flex","items-center","justify-between","space-x-3"],[1,"space-y-2"],["width","100%","height","5rem"],["width","100%","height","200px"],["shape","circle","size","32px"],["width","5rem","height","1rem"],["width","7rem","height","1rem"]],template:function(t,s){t&1&&(n(0,"div",0),c(1,"app-breadcrumb",1),n(2,"h3",2),a(3," Order Details "),r(),v(4,tt,38,16,"div",3)(5,nt,13,1,"div",3),r()),t&2&&(m(),x("pages",Q(5,Je,D(2,He),G(3,Ke,"/orders/"+s.id))),m(3),h(s.order()?4:5))},dependencies:[ve,Ee,Oe,M,A,$,re],changeDetection:0});let e=i;return e})();export{Nt as UserOrderDetailsComponent};

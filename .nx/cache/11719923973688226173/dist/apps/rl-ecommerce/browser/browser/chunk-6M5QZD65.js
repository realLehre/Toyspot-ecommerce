import{a as c}from"./chunk-HULGCXHD.js";import{a as m}from"./chunk-JMTCKGXD.js";import{b as h,c as p}from"./chunk-BLPDBI5E.js";import{M as u,R as d,X as a,ab as o,j as n}from"./chunk-RY22DRUR.js";var y=(()=>{let r=class r{constructor(){this.userService=a(c),this.http=a(p),this.apiUrl=m.apiUrl+"order",this.user=this.userService.user,this.orderSignal=o(null),this.activeOrder=o(null),this.orderQueried=o(!1)}getOrder(t){this.orderQueried.set(!1);let e=new h;return t?.minPrice&&(e=e.set("minPrice",t.minPrice.toString()),this.orderQueried.set(!0)),t?.maxPrice&&(e=e.set("maxPrice",t.maxPrice.toString()),this.orderQueried.set(!0)),t?.deliveryStatus&&(e=e.set("deliveryStatus",t.deliveryStatus),this.orderQueried.set(!0)),t?.page&&(e=e.set("page",t.page)),t?.itemsToShow&&(e=e.set("pageSize",t.itemsToShow)),t?.orderId&&(e=e.set("orderId",t.orderId),this.orderQueried.set(!0)),t?.minDate&&(e=e.set("minDate",t.minDate),this.orderQueried.set(!0)),t?.maxDate&&(e=e.set("maxDate",t.maxDate),this.orderQueried.set(!0)),this.orderSignal()?n(this.orderSignal()):this.http.get(`${this.apiUrl}/${this.user()?.id}`,{params:e}).pipe(u(i=>{this.orderSignal.set(i)}))}getOrderById(t){return this.http.get(`${this.apiUrl}/user/${t}`)}placeOrder(t){let e={userId:this.user()?.id,cart:t.cart,shippingInfoId:t.address.id,orderAmount:this.getTotalItemAmount(t.cart),shippingCost:this.getShippingCost(t.cart),totalAmount:this.getTotalItemAmount(t.cart)+this.getShippingCost(t.cart),paymentMethod:t.paymentMethod,orderStatus:"CONFIRMED",deliveryStatus:"PENDING"};return this.http.post(`${this.apiUrl}/create`,e)}getTotalItemAmount(t){return t.cartItems.reduce((e,i)=>e+=i.total,0)}getShippingCost(t){return t.cartItems.reduce((e,i)=>e+=i.shippingCost,0)}formatDate(t){return new Date(t).toISOString()}formatDateToLocale(t){return new Date(t)}};r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=d({token:r,factory:r.\u0275fac,providedIn:"root"});let s=r;return s})();export{y as a};

import{a as W}from"./chunk-773VB3WD.js";import{a as G}from"./chunk-4WILG7NK.js";import{a as $}from"./chunk-PWBNNIEZ.js";import{a as O}from"./chunk-ZFTML6IP.js";import{a as Q}from"./chunk-ROMTXCYZ.js";import{b as B}from"./chunk-JQIRRWHU.js";import{a as N}from"./chunk-HULGCXHD.js";import{a as Z}from"./chunk-XNVULCNU.js";import{m as H}from"./chunk-BLPDBI5E.js";import{o as F,t as z}from"./chunk-BKPILUOD.js";import{$ as I,Ab as A,Cc as j,Db as x,Eb as m,Mb as g,Oa as w,Ob as y,Ta as s,Vb as k,Wb as L,X as c,Xb as M,ab as v,cc as R,fc as U,hb as b,ja as _,ka as S,kb as d,la as P,pb as T,sb as q,tb as E,ub as a,va as V,vb as l,wb as u}from"./chunk-RY22DRUR.js";import{a as p,b as h}from"./chunk-ODN5LVDJ.js";var J=(i,n)=>n.star,K=i=>({width:i}),Y=()=>({width:"18px",border:"3px solid #000"});function X(i,n){if(i&1&&(a(0,"div",11),u(1,"i",17)(2,"i",18),l()),i&2){let o=n.$index,t=m();s(2),d("ngStyle",M(1,K,t.getStarWidth(o)))}}function tt(i,n){i&1&&u(0,"app-loader",20),i&2&&d("customStyle",L(1,Y))}function et(i,n){i&1&&(a(0,"span",21),g(1,"Add to Cart"),l())}function it(i,n){if(i&1){let o=A();a(0,"button",19),x("click",function(){_(o);let r=m();return S(r.onAddToCart())}),b(1,tt,1,2,"app-loader",20)(2,et,2,0,"span",21),P(),a(3,"svg",22),u(4,"path",23),l()()}if(i&2){let o=m();d("disabled",o.isAddingToCart()),s(),T(o.isAddingToCart()?1:2)}}function rt(i,n){if(i&1){let o=A();a(0,"app-product-quantity",24),x("quantityChanged",function(r){_(o);let e=m();return S(e.onAdjustQuantity(r))}),l()}if(i&2){let o,t=m();d("quantity",(o=t.productInCart())==null?null:o.unit)("isLoading",t.isUpdatingCart())}}var xt=(()=>{let n=class n{constructor(){this.router=c(H),this.productService=c($),this.toast=c(O),this.cartService=c(Q),this.userService=c(N),this.reviewService=c(W),this.user=this.userService.user,this.product=V.required(),this.isAddingToCart=v(!1),this.stars=v(Array.from({length:5},(t,r)=>({star:r+1,active:!1}))),this.quantity=1,this.isUpdatingCart=v(!1),this.productInCart=j(()=>{if(this.cartService.cartSignal())return this.cartService.cartSignal()?.cartItems?.find(t=>t.productId===this.product().id)})}onViewDetails(t){this.productService.activeProduct.set(t),this.reviewService.seeingFullReview.set(!1),this.router.navigate(["/product/"+this.productService.createSlug(t.name)],{queryParams:{id:t.id}})}onAddToCart(){this.user()&&this.isAddingToCart.set(!0),this.cartService.addToCart({product:this.product(),unit:1}).subscribe({next:t=>{this.isAddingToCart.set(!1);let r=this.cartService.cartTotal;this.cartService.cartTotal.set(r()+1);let e=p({},this.cartService.cartSignal())||{};this.cartService.cartSignal.set(null),this.cartService.getCart().subscribe();let f=h(p({},t),{product:this.product()});this.cartService.cartSignal.set(h(p({},this.cartService.cartSignal()),{cartItems:[...e?.cartItems,f]})),this.toast.showToast({type:"success",message:`${this.product().name} added to cart!`})},error:t=>{this.isAddingToCart.set(!1),this.toast.showToast({type:"error",message:t.error.message})}})}onAdjustQuantity(t){this.isUpdatingCart.set(!0),this.quantity=t,this.cartService.updateCartItem({itemId:this.productInCart()?.id,unit:this.quantity,productPrice:this.product()?.price}).subscribe({next:r=>{this.isUpdatingCart.set(!1);let e=this.cartService.cartSignal();if(e){let f=e.cartItems.map(C=>C.id===this.productInCart()?.id?h(p({},C),{unit:t,total:t*C.product.price}):C),D=h(p({},e),{cartItems:f});this.cartService.cartSignal.set(D),localStorage.setItem(this.cartService.CART_KEY,JSON.stringify(D))}},error:r=>{this.isUpdatingCart.set(!1)}})}averageRating(){return this.product().ratings.reduce((r,e)=>r+e.rating,0)/this.product().ratings.length||0}getStarWidth(t){let r=Math.floor(this.averageRating()),e=this.averageRating()%1*100;return t<r?"100%":t===r?`${e}%`:"0%"}};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=I({type:n,selectors:[["app-product-card"]],inputs:{product:[1,"product"]},standalone:!0,features:[k],decls:23,vars:13,consts:[[1,"flex","flex-col","space-y-1","mobile:space-y-3"],[1,"relative","w-full","h-[180px]","mobile:h-[230px]","group",3,"click"],[1,"absolute","top-0","left-0","w-full","h-full","bg-[#3D3D3D]","clip-polygon","z-[100]"],[1,"absolute","top-1/2","left-1/2","-translate-y-1/2","-translate-x-1/2","w-[99%]","h-[99%]","bg-white","clip-polygon","z-[101]"],[1,"absolute","top-1/2","left-1/2","-translate-y-1/2","-translate-x-1/2","w-[93%]","h-[93%]","bg-[#3D3D3D]","clip-polygon","z-[102]"],[1,"absolute","top-1/2","left-1/2","-translate-y-1/2","-translate-x-1/2","w-[92%]","h-[92%]","bg-[#3D3D3D]","clip-polygon","z-[103]"],["alt","",1,"hidden","group-hover:inline","w-full","h-full","object-cover",3,"src","alt"],[1,"inline","group-hover:hidden","w-full","h-full","object-cover",3,"src","alt"],[1,"w-full"],[1,"text-base","md:text-lg","font-medium","text-type_title_gray","w-full","break-words","truncate"],[1,"flex","items-center","space-x-1","mb-1","mobile:mb-3"],[1,"relative","w-[20px]","h-[20px]"],[1,"text-type_title_gray"],[1,"flex","items-start","mobile:items-center","flex-col","mobile:flex-row","justify-between","gap-x-2","gap-y-4"],[1,"text-type_title","md:text-lg","text-base","font-semibold"],[1,"flex","items-center","rounded-full","justify-between","space-x-2","border-[2px]","border-primary","px-3","py-2","whitespace-nowrap","text-xs","w-full","mobile:w-auto","min-w-[100px]","text-type_title_gray","group","hover:bg-primary","hover:text-white",3,"disabled"],[3,"quantity","isLoading"],[1,"fa","fa-star","w-full","h-full","text-gray-300","text-[20px]"],[1,"fa","fa-star","h-full","text-[20px]","text-yellow-400","absolute","top-0","left-0","overflow-hidden",3,"ngStyle"],[1,"flex","items-center","rounded-full","justify-between","space-x-2","border-[2px]","border-primary","px-3","py-2","whitespace-nowrap","text-xs","w-full","mobile:w-auto","min-w-[100px]","text-type_title_gray","group","hover:bg-primary","hover:text-white",3,"click","disabled"],[3,"customStyle"],[1,"font-medium"],["width","18","height","19","viewBox","0 0 32 33","fill","none","xmlns","http://www.w3.org/2000/svg",1,"fill-type_title_gray","group-hover:!fill-white"],["d","M5.33328 9.05198L1.00928 4.72932L2.89594 2.84265L7.21861 7.16665H27.5413C27.7491 7.16664 27.954 7.2152 28.1398 7.30847C28.3255 7.40175 28.4868 7.53714 28.6109 7.70385C28.735 7.87055 28.8184 8.06396 28.8545 8.26863C28.8905 8.4733 28.8783 8.68357 28.8186 8.88265L25.6186 19.5493C25.5363 19.8241 25.3675 20.065 25.1374 20.2363C24.9073 20.4075 24.6281 20.5 24.3413 20.5H7.99994V23.1667H22.6666V25.8333H6.66661C6.31299 25.8333 5.97385 25.6928 5.7238 25.4428C5.47375 25.1927 5.33328 24.8536 5.33328 24.5V9.05198ZM7.99994 9.83332V17.8333H23.3493L25.7493 9.83332H7.99994ZM7.33328 31.1667C6.80284 31.1667 6.29414 30.9559 5.91906 30.5809C5.54399 30.2058 5.33328 29.6971 5.33328 29.1667C5.33328 28.6362 5.54399 28.1275 5.91906 27.7524C6.29414 27.3774 6.80284 27.1667 7.33328 27.1667C7.86371 27.1667 8.37242 27.3774 8.74749 27.7524C9.12256 28.1275 9.33328 28.6362 9.33328 29.1667C9.33328 29.6971 9.12256 30.2058 8.74749 30.5809C8.37242 30.9559 7.86371 31.1667 7.33328 31.1667ZM23.3333 31.1667C22.8028 31.1667 22.2941 30.9559 21.9191 30.5809C21.544 30.2058 21.3333 29.6971 21.3333 29.1667C21.3333 28.6362 21.544 28.1275 21.9191 27.7524C22.2941 27.3774 22.8028 27.1667 23.3333 27.1667C23.8637 27.1667 24.3724 27.3774 24.7475 27.7524C25.1226 28.1275 25.3333 28.6362 25.3333 29.1667C25.3333 29.6971 25.1226 30.2058 24.7475 30.5809C24.3724 30.9559 23.8637 31.1667 23.3333 31.1667Z"],[3,"quantityChanged","quantity","isLoading"]],template:function(r,e){r&1&&(a(0,"div",0)(1,"div",1),x("click",function(){return e.onViewDetails(e.product())}),u(2,"div",2)(3,"div",3)(4,"div",4),a(5,"div",5),u(6,"img",6)(7,"img",7),l()(),a(8,"div",8)(9,"h3",9),g(10),l(),a(11,"div",10),q(12,X,3,3,"div",11,J),a(14,"span",12),g(15),l()(),a(16,"div",13)(17,"p",14),g(18),R(19,"currency"),l(),a(20,"div"),b(21,it,5,2,"button",15)(22,rt,1,2,"app-product-quantity",16),l()()()()),r&2&&(s(6),d("src",e.product().imageUrls[1],w)("alt",e.product().name),s(),d("src",e.product().image,w)("alt",e.product().name),s(3),y(" ",e.product().name," "),s(2),E(e.stars()),s(3),y("(",e.product().ratings.length,")"),s(3),y(" ",U(19,8,e.product().price,"\u20A6","symbol","1.0-0")," "),s(3),T(e.productInCart()?22:21))},dependencies:[z,B,Z,F,G],styles:[".clip-polygon[_ngcontent-%COMP%]{clip-path:polygon(0 18%,25% 0,100% 0,100% 82%,75% 100%,0% 100%)}"],changeDetection:0});let i=n;return i})();export{xt as a};

import{a as Re}from"./chunk-6M5QZD65.js";import{a as Le}from"./chunk-73ZKYXDV.js";import{a as Ie,f as Ae,g as Q,k as H,t as U,u as Te}from"./chunk-HPREADP6.js";import{a as Pe}from"./chunk-ZFTML6IP.js";import{a as De,b as Ve,c as Ne}from"./chunk-EW7AGQTV.js";import{a as Be,b as Fe}from"./chunk-TVXJGPRZ.js";import{a as Oe}from"./chunk-ENH4ZRLB.js";import{a as Me}from"./chunk-ROMTXCYZ.js";import{a as z,b as K}from"./chunk-JQIRRWHU.js";import"./chunk-HULGCXHD.js";import{a as Ee}from"./chunk-XNVULCNU.js";import{f as ke}from"./chunk-L6YWE27G.js";import{a as we}from"./chunk-JMTCKGXD.js";import{a as ve,c as Ce,m as xe,n as Se}from"./chunk-BLPDBI5E.js";import{k as ye,n as _e,o as be,t as ge,u as q}from"./chunk-BKPILUOD.js";import{$ as b,Ab as T,Ac as Z,Bc as fe,Db as m,Eb as f,Ib as le,Jb as de,Kb as ce,Lb as J,Mb as d,Nb as w,Oa as ae,Ob as x,Q as ee,R as N,Rb as B,S as te,Sb as F,Ta as l,Tb as P,Ua as I,Ub as pe,Vb as k,Wb as S,X as _,Yb as me,Zb as X,_b as ue,aa as ie,ab as A,cb as se,cc as E,dc as G,fc as O,hb as h,ja as v,jb as M,ka as C,kb as p,la as ne,ob as $,pa as oe,pb as g,ra as L,sb as j,tb as W,ua as R,ub as r,uc as he,va as re,vb as a,wb as u}from"./chunk-RY22DRUR.js";import"./chunk-X5YLR3NI.js";import"./chunk-ODN5LVDJ.js";var He=["input"],Ue=(t,o,e,n)=>({"p-radiobutton p-component":!0,"p-radiobutton-checked":t,"p-radiobutton-disabled":o,"p-radiobutton-focused":e,"p-variant-filled":n}),Ye=(t,o,e)=>({"p-radiobutton-box":!0,"p-highlight":t,"p-disabled":o,"p-focus":e}),$e=(t,o,e)=>({"p-radiobutton-label":!0,"p-radiobutton-label-active":t,"p-disabled":o,"p-radiobutton-label-focus":e});function Je(t,o){if(t&1){let e=T();r(0,"label",7),m("click",function(i){v(e);let s=f();return C(s.select(i))}),d(1),a()}if(t&2){let e=f(),n=J(3);$(e.labelStyleClass),p("ngClass",X(6,$e,n.checked,e.disabled,e.focused)),M("for",e.inputId)("data-pc-section","label"),l(),w(e.label)}}var Xe={provide:Ie,useExisting:ee(()=>V),multi:!0},Ze=(()=>{class t{accessors=[];add(e,n){this.accessors.push([e,n])}remove(e){this.accessors=this.accessors.filter(n=>n[1]!==e)}select(e){this.accessors.forEach(n=>{this.isSameGroup(n,e)&&n[1]!==e&&n[1].writeValue(e.value)})}isSameGroup(e,n){return e[0].control?e[0].control.root===n.control.control.root&&e[1].name===n.name:!1}static \u0275fac=function(n){return new(n||t)};static \u0275prov=N({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),V=(()=>{class t{cd;injector;registry;config;value;formControlName;name;disabled;label;variant="outlined";tabindex;inputId;ariaLabelledBy;ariaLabel;style;styleClass;labelStyleClass;autofocus;onClick=new L;onFocus=new L;onBlur=new L;inputViewChild;onModelChange=()=>{};onModelTouched=()=>{};checked;focused;control;constructor(e,n,i,s){this.cd=e,this.injector=n,this.registry=i,this.config=s}ngOnInit(){this.control=this.injector.get(Ae),this.checkName(),this.registry.add(this.control,this)}handleClick(e,n,i){e.preventDefault(),!this.disabled&&(this.select(e),i&&n.focus())}select(e){this.disabled||(this.inputViewChild.nativeElement.checked=!0,this.checked=!0,this.onModelChange(this.value),this.registry.select(this),this.onClick.emit({originalEvent:e,value:this.value}))}writeValue(e){this.checked=e==this.value,this.inputViewChild&&this.inputViewChild.nativeElement&&(this.inputViewChild.nativeElement.checked=this.checked),this.cd.markForCheck()}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onInputFocus(e){this.focused=!0,this.onFocus.emit(e)}onInputBlur(e){this.focused=!1,this.onModelTouched(),this.onBlur.emit(e)}focus(){this.inputViewChild.nativeElement.focus()}ngOnDestroy(){this.registry.remove(this)}checkName(){this.name&&this.formControlName&&this.name!==this.formControlName&&this.throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}throwNameError(){throw new Error(`
          If you define both a name and a formControlName attribute on your radio button, their values
          must match. Ex: <p-radioButton formControlName="food" name="food"></p-radioButton>
        `)}static \u0275fac=function(n){return new(n||t)(I(he),I(oe),I(Ze),I(ke))};static \u0275cmp=b({type:t,selectors:[["p-radioButton"]],viewQuery:function(n,i){if(n&1&&le(He,5),n&2){let s;de(s=ce())&&(i.inputViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{value:"value",formControlName:"formControlName",name:"name",disabled:[2,"disabled","disabled",Z],label:"label",variant:"variant",tabindex:[2,"tabindex","tabindex",fe],inputId:"inputId",ariaLabelledBy:"ariaLabelledBy",ariaLabel:"ariaLabel",style:"style",styleClass:"styleClass",labelStyleClass:"labelStyleClass",autofocus:[2,"autofocus","autofocus",Z]},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},features:[pe([Xe]),se],decls:7,vars:31,consts:[["input",""],[3,"click","ngStyle","ngClass"],[1,"p-hidden-accessible"],["type","radio","pAutoFocus","",3,"focus","blur","checked","disabled","value","autofocus"],[3,"ngClass"],[1,"p-radiobutton-icon"],[3,"class","ngClass","click",4,"ngIf"],[3,"click","ngClass"]],template:function(n,i){if(n&1){let s=T();r(0,"div",1),m("click",function(c){v(s);let Qe=J(3);return C(i.handleClick(c,Qe,!0))}),r(1,"div",2)(2,"input",3,0),m("focus",function(c){return v(s),C(i.onInputFocus(c))})("blur",function(c){return v(s),C(i.onInputBlur(c))}),a()(),r(4,"div",4),u(5,"span",5),a()(),h(6,Je,2,10,"label",6)}n&2&&($(i.styleClass),p("ngStyle",i.style)("ngClass",ue(22,Ue,i.checked,i.disabled,i.focused,i.variant==="filled"||i.config.inputStyle()==="filled")),M("data-pc-name","radiobutton")("data-pc-section","root"),l(),M("data-pc-section","hiddenInputWrapper"),l(),p("checked",i.checked)("disabled",i.disabled)("value",i.value)("autofocus",i.autofocus),M("id",i.inputId)("name",i.name)("aria-labelledby",i.ariaLabelledBy)("aria-label",i.ariaLabel)("tabindex",i.tabindex)("aria-checked",i.checked)("data-pc-section","hiddenInput"),l(2),p("ngClass",X(27,Ye,i.checked,i.disabled,i.focused)),M("data-pc-section","input"),l(),M("data-pc-section","icon"),l(),p("ngIf",i.label))},dependencies:[ye,_e,be,Be],encapsulation:2,changeDetection:0})}return t})(),Y=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=ie({type:t});static \u0275inj=te({imports:[q,Fe]})}return t})();var it=(t,o)=>o.id,We=()=>["/","user","address-management"],nt=()=>({add:!0}),ot=()=>({edit:!0});function rt(t,o){if(t&1&&(r(0,"span"),d(1),a()),t&2){let e=f().$implicit;l(),x(" / ",e.additionalPhoneNumber," ")}}function at(t,o){t&1&&(r(0,"p",12),d(1,"Default Address"),a())}function st(t,o){if(t&1){let e=T();r(0,"div",2)(1,"div",4)(2,"div")(3,"p-radioButton",5),P("ngModelChange",function(i){v(e);let s=f(2);return F(s.selectedAddress,i)||(s.selectedAddress=i),C(i)}),m("ngModelChange",function(){v(e);let i=f(2);return C(i.onSelectAddress())}),a()(),r(4,"div",6)(5,"div")(6,"h2",7),d(7),a(),r(8,"div",8)(9,"p",9)(10,"span",10),d(11,"Delivery address:"),a(),r(12,"span"),d(13),a()(),r(14,"p",9)(15,"span",10),d(16,"City:"),a(),r(17,"span"),d(18),a()(),r(19,"p",11)(20,"span"),d(21),a(),h(22,rt,2,1,"span"),a()()(),h(23,at,2,0,"p",12),a()(),r(24,"div")(25,"button",13),m("click",function(){let i=v(e).$implicit,s=f(2);return C(s.onEditAddress(i))}),ne(),r(26,"svg",14),u(27,"path",15),a()()()()}if(t&2){let e=o.$implicit,n=f(2);l(3),p("value",e),B("ngModel",n.selectedAddress),l(4),x(" ",e.name," "),l(6),w(e.deliveryAddress),l(5),w(e.city),l(3),w(e.phoneNumber),l(),g(e.additionalPhoneNumber?22:-1),l(),g(e.isDefault?23:-1),l(2),p("routerLink",S(10,We))("queryParams",S(11,ot))}}function lt(t,o){if(t&1&&(j(0,st,28,12,"div",2,it),r(2,"button",1),u(3,"i",3),r(4,"span"),d(5,"Add Address"),a()()),t&2){let e=f();W(e.addresses),l(2),p("routerLink",S(2,We))("queryParams",S(3,nt))}}function dt(t,o){t&1&&(r(0,"div"),u(1,"p-skeleton",16),a())}var Ge=(()=>{let o=class o{constructor(){this.addressService=_(Le),this.isLoading=A(!0),this.selectedAddressEmit=R()}ngOnInit(){this.addressService.getAddress().subscribe(n=>{this.isLoading.set(!1),this.addresses=n,this.selectedAddress=n.find(i=>i.isDefault),this.selectedAddressEmit.emit(this.selectedAddress)})}onEditAddress(n){this.addressService.activeAddress.set(n)}onSelectAddress(){this.selectedAddressEmit.emit(this.selectedAddress)}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=b({type:o,selectors:[["app-checkout-address"]],outputs:{selectedAddressEmit:"selectedAddressEmit"},standalone:!0,features:[k],decls:3,vars:1,consts:[[1,"space-y-4","pt-5","w-full"],[1,"border-0","outline-0","text-primary","font-semibold","py-2","mt-4",3,"routerLink","queryParams"],[1,"bg-bg_subtle","rounded-lg","shadow-md","p-4","flex","items-start","justify-between","h-full","w-full","space-x-3"],[1,"fa","fa-plus","mr-1"],[1,"flex","max-w-[250px]","items-start"],["name","address",3,"ngModelChange","value","ngModel"],[1,"break-words","w-full","ml-3"],[1,"font-medium","text-gray-800"],[1,"space-y-1","mt-2","text-sm"],[1,"text-type_grey","break-words","space-x-1"],[1,"text-type_title_gray","font-medium"],[1,"text-type_caption","text-sm"],[1,"mt-5","text-primary","font-medium"],[1,"text-blue-500","hover:text-blue-600","w-6","h-6",3,"click","routerLink","queryParams"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20",1,"h-5","w-5","fill-type_grey"],["d","M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"],["width","100%","height","450px"]],template:function(i,s){i&1&&(r(0,"div",0),h(1,lt,6,4,"button",1)(2,dt,2,0,"div"),a()),i&2&&(l(),g(s.isLoading()?2:1))},dependencies:[U,Q,H,Te,Y,V,Se,K,z],changeDetection:0});let t=o;return t})();var ct=(t,o)=>o.id;function pt(t,o){if(t&1&&(r(0,"div",4)(1,"div",8),u(2,"img",9),r(3,"div",10)(4,"p"),d(5),a(),r(6,"p",11),d(7),a()()(),r(8,"p",12),d(9),E(10,"currency"),a()()),t&2){let e=o.$implicit;l(2),p("src",e==null||e.product==null?null:e.product.image,ae)("alt",e==null||e.product==null?null:e.product.name),l(3),w(e==null||e.product==null?null:e.product.name),l(2),x("x",e.unit,""),l(2),x(" ",O(10,5,e.total,"\u20A6","symbol","1.0-0")," ")}}function mt(t,o){if(t&1&&(r(0,"div")(1,"div",1)(2,"div",2)(3,"p"),d(4,"Product"),a(),r(5,"p"),d(6,"Total"),a()(),r(7,"div",3),j(8,pt,11,10,"div",4,ct),a()(),r(10,"div",5)(11,"p"),d(12,"Subtotal"),a(),r(13,"p",6),d(14),E(15,"subtotal"),E(16,"currency"),a()(),r(17,"div",5)(18,"p"),d(19,"Delivery Fee"),a(),r(20,"p",6),d(21),E(22,"totalDelivery"),E(23,"currency"),a()(),r(24,"div",5)(25,"p"),d(26,"Total"),a(),r(27,"p",7),d(28),E(29,"grandTotal"),E(30,"currency"),a()()()),t&2){let e=f();l(8),W(e.cart().cartItems),l(6),x(" ",O(16,5,G(15,3,e.cart().cartItems),"\u20A6","symbol","1.0-0")," "),l(7),x(" ",O(23,12,G(22,10,e.cart().cartItems),"\u20A6","symbol","1.0-0")," "),l(7),x(" ",O(30,19,G(29,17,e.cart().cartItems),"\u20A6","symbol","1.0-0")," ")}}function ut(t,o){t&1&&(r(0,"div"),u(1,"p-skeleton",13),a())}var qe=(()=>{let o=class o{constructor(){this.cart=re({})}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=b({type:o,selectors:[["app-order-summary"]],inputs:{cart:[1,"cart"]},standalone:!0,features:[k],decls:3,vars:1,consts:[[1,"pt-5"],[1,"pb-3","border-b-[2px]","border-border_subtle"],[1,"flex","items-center","justify-between","space-x-3","text-sm","mobile:text-[20px]","text-type_title_gray","mb-3"],[1,"space-y-2"],[1,"flex","items-center","justify-between","space-x-3","text-sm","mobile:text-[20px]","text-type_title_gray"],[1,"flex","items-center","justify-between","space-x-4","text-sm","mobile:text-base","text-type_title_gray","py-3","border-b-[2px]","border-border_subtle"],[1,"text-type_title_gray","font-semibold"],[1,"text-type_title_gray","font-semibold","text-lg","mobile:text-2xl"],[1,"flex","items-center","space-x-2","w-[70%]"],[1,"w-12","h-12","min-w-12","min-h-12","object-cover",3,"src","alt"],[1,"text-sm","text-type_grey","break-words"],[1,"text-type_title","font-semibold"],[1,"text-sm","mobile:text-base","text-type_grey","w-[30%]","text-right","whitespace-nowrap"],["width","100%","height","450px"]],template:function(i,s){i&1&&(r(0,"div",0),h(1,mt,31,24,"div")(2,ut,2,0,"div"),a()),i&2&&(l(),g(s.cart()?1:2))},dependencies:[ge,De,Ve,Ne,K,z],changeDetection:0});let t=o;return t})();function ht(t,o){t&1&&(r(0,"div",7)(1,"p",8),d(2," The amount displayed in the payment window may be lower than your actual cart amount due to limitations on the Paystack test account. "),a()())}var ze=(()=>{let o=class o{constructor(){this.paymentOptionSelected=R()}onSelectPaymentMethod(){this.paymentOptionSelected.emit(this.paymentOption)}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=b({type:o,selectors:[["app-payment-options"]],outputs:{paymentOptionSelected:"paymentOptionSelected"},standalone:!0,features:[k],decls:10,vars:3,consts:[[1,"border-[2px]","border-border_subtle","rounded-xl"],[1,"flex","items-center","p-4","border-b-[2px]","border-border_subtle"],["name","payment","value","pay on delivery","inputId","payOnDelivery",3,"ngModelChange","ngModel"],["for","payOnDelivery",1,"ml-2"],[1,"flex","items-center","p-4"],["name","payment","value","paystack","inputId","paystack",3,"ngModelChange","ngModel"],["for","paystack",1,"ml-2"],[1,"mt-3","p-2","bg-yellow-400"],[1,"text-sm"]],template:function(i,s){i&1&&(r(0,"div",0)(1,"div",1)(2,"p-radioButton",2),P("ngModelChange",function(c){return F(s.paymentOption,c)||(s.paymentOption=c),c}),m("ngModelChange",function(){return s.onSelectPaymentMethod()}),a(),r(3,"label",3),d(4," Pay on delivery "),a()(),r(5,"div",4)(6,"p-radioButton",5),P("ngModelChange",function(c){return F(s.paymentOption,c)||(s.paymentOption=c),c}),m("ngModelChange",function(){return s.onSelectPaymentMethod()}),a(),r(7,"label",6),d(8," Pay with paystack "),a()()(),h(9,ht,3,0,"div",7)),i&2&&(l(2),B("ngModel",s.paymentOption),l(4),B("ngModel",s.paymentOption),l(3),g(s.paymentOption==="paystack"?9:-1))},dependencies:[Y,V,q,U,Q,H],changeDetection:0});let t=o;return t})();var Ke=(()=>{let o=class o{constructor(){this.http=_(Ce),this.paystackKey=we.paystackKey,this.url="https://api.paystack.co/transaction/initialize"}initiatePayment(n){let i=new ve({Authorization:`Bearer ${this.paystackKey}`});return this.http.post(this.url,n,{headers:i})}};o.\u0275fac=function(i){return new(i||o)},o.\u0275prov=N({token:o,factory:o.\u0275fac,providedIn:"root"});let t=o;return t})();var ft=()=>({name:"my cart",route:"/cart"}),yt=()=>({name:"checkout",route:"/checkout"}),_t=(t,o)=>[t,o],bt=()=>({width:"24px",border:"3px solid #fff"});function gt(t,o){t&1&&u(0,"app-loader",13),t&2&&p("customStyle",S(1,bt))}var xi=(()=>{let o=class o{constructor(){this.cartService=_(Me),this.orderService=_(Re),this.paymentService=_(Ke),this.toast=_(Pe),this.router=_(xe),this.cart=this.cartService.cartSignal,this.isLoading=A(!1),this.isInitiatingPayment=A(!1)}onSelectedAddress(n){this.selectedAddress=n}onSelectPaymentMethod(n){this.selectPaymentMethod=n}onInitiateOrder(){this.selectPaymentMethod=="pay on delivery"?this.onPlaceOrder():(this.isInitiatingPayment.set(!0),this.paymentService.initiatePayment({amount:1e5,email:"beed@beed.com"}).subscribe({next:n=>{this.isInitiatingPayment.set(!1);let i=Math.round((this.orderService.getTotalItemAmount(this.cart())+this.orderService.getShippingCost(this.cart()))*100);new PaystackPop().newTransaction({key:"pk_test_b95a88357b0b5b7c4e20ccceb1ac928bb2f9a5bf",email:"hhh@dudd.com",amount:Math.min(i,1e7),currency:"NGN",channels:["card"],callback:y=>{this.onPlaceOrder()},onClose:()=>{}})},error:n=>{this.isInitiatingPayment.set(!1),this.toast.showToast({type:"error",message:n.error.message})}}))}onPlaceOrder(){this.isLoading.set(!0),this.orderService.placeOrder({address:this.selectedAddress,cart:this.cart(),paymentMethod:this.selectPaymentMethod}).subscribe({next:n=>{this.router.navigate(["/","orders"]),localStorage.removeItem(this.cartService.CART_KEY),setTimeout(()=>{this.cartService.cartSignal.set(null)},300),this.cartService.cartTotal.set(null),this.cartService.getCart().subscribe(),this.orderService.orderSignal.set(null),this.toast.showToast({type:"success",message:"Order placed successfully!"}),this.isLoading.set(!1)},error:n=>{this.toast.showToast({type:"error",message:n.error.message}),this.isLoading.set(!1)}})}};o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=b({type:o,selectors:[["app-checkout"]],standalone:!0,features:[k],decls:21,vars:9,consts:[[1,"w-[90%]","tablet:w-[85%]","max-w-[1200px]","mx-auto","mt-9","mobile:mt-[80px]"],[3,"pages"],[1,"block","mobile:hidden","font-medium","text-lg","text-type_title","mt-4"],[1,"mt-8","flex","flex-col","min-[750px]:flex-row","gap-y-8","gap-x-6","items-start"],[1,"space-y-4","grow","w-full","min-[750px]:w-[60%]"],[1,"font-semibold","text-type_title"],[3,"selectedAddressEmit"],[1,"space-y-4","grow","w-full","min-[750px]:w-[40%]"],[3,"cart"],[1,"mt-3"],[1,"font-semibold","text-type_title","mb-2"],[3,"paymentOptionSelected"],[1,"w-full","flex","items-center","justify-center","space-x-3","rounded-full","text-white","font-medium","bg-primary","hover:bg-opacity-75","py-2","h-12","disabled:bg-opacity-25","disabled:cursor-not-allowed","mt-10",3,"click","disabled"],[3,"customStyle"]],template:function(i,s){i&1&&(r(0,"div",0),u(1,"app-breadcrumb",1),r(2,"h3",2),d(3," Checkout "),a(),r(4,"div",3)(5,"div",4)(6,"h3",5),d(7,"Billing Address"),a(),r(8,"app-checkout-address",6),m("selectedAddressEmit",function(c){return s.onSelectedAddress(c)}),a()(),r(9,"div",7)(10,"h3",5),d(11,"Your order"),a(),u(12,"app-order-summary",8),r(13,"div",9)(14,"h3",10),d(15,"Payment"),a(),r(16,"app-payment-options",11),m("paymentOptionSelected",function(c){return s.onSelectPaymentMethod(c)}),a(),r(17,"button",12),m("click",function(){return s.onInitiateOrder()}),h(18,gt,1,2,"app-loader",13),r(19,"span"),d(20,"Place order"),a()()()()()()),i&2&&(l(),p("pages",me(6,_t,S(4,ft),S(5,yt))),l(11),p("cart",s.cart()),l(5),p("disabled",!s.selectPaymentMethod||!s.selectedAddress||!s.cart().cartItems.length),l(),g(s.isLoading()||s.isInitiatingPayment()?18:-1))},dependencies:[Oe,Ge,qe,ze,Ee],changeDetection:0});let t=o;return t})();export{xi as CheckoutComponent};
